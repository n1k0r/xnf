# ethertype is reserved identifier for top protocol
ethertype(0x800) -> ip4

proto ip4 {
    : 4b
    ihl: uint(4b)
    : 1B
    len: uint(2B)
    : 4B
    ttl: uint(1B)
    ipproto: uint(1B)!
    : 2B
    src: addr4(4B)
    dst: addr4(4B)
    : 4B * ihl
}

ethertype(0x86DD) -> ip6

proto ip6 {
    : 6B
    next: uint(1B)!
    : 1B
    src: addr6(16B)
    dst: addr6(16B)
}

ip4(6) -> tcp

proto tcp {
    from: uint(2B)
    to: uint(2B)!
    : 8B
    : 11b
    ack : uint(1b)
    : 20b
    : 4B
}

ip4(17) -> udp

proto udp {
    from: uint(2B)
    to: uint(2B)!
    : 4B
}
